<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>TLS 1.3 Impact on Network-Based Security</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements notation">
<link href="#rfc.section.2" rel="Chapter" title="2 TLS 1.3 Change Impact Overview">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Inbound Session Change Impacts">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Removal of Static RSA and Diffie-Hellman Cipher Suites">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Outbound Session Change Impacts">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Encrypted Server Certificate">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 Resumption and Pre-Shared Key">
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 Version Downgrade Protection">
<link href="#rfc.section.2.2.4" rel="Chapter" title="2.2.4 1-RTT Handshake">
<link href="#rfc.section.2.2.5" rel="Chapter" title="2.2.5 0-RTT Data">
<link href="#rfc.section.2.2.6" rel="Chapter" title="2.2.6 SNI Encryption in TLS Through Tunneling">
<link href="#rfc.section.3" rel="Chapter" title="3 Inbound Session Use Cases">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Use Case I1 - Data Center Protection">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Use Case I2 - Application Operation over NAT">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Use Case I3 - Compliance">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Use Case I4 - Crypto Security Audit">
<link href="#rfc.section.4" rel="Chapter" title="4 Outbound Session Use Cases">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Use Case O1 - Acceptable Use Policy (AUP)">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Use Case O2 - Malware and Threat Protection">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Use Case O3 - IoT Endpoints">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Use Case O4 - Unpatched Endpoints">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Use Case O5 - Rapid Containment of New Vulnerability and Campaigns">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 Use Case O6 - End-of-Life Endpoint">
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Use Case O7 - Compliance">
<link href="#rfc.section.4.8" rel="Chapter" title="4.8 Use Case O8 - Crypto Security Audit">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.section.8" rel="Chapter" title="8 Change Log">
<link href="#rfc.section.9" rel="Chapter" title="9 Contributors">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.8.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Cam-Winget, N., Wang, E., and F. Andreasen" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-camwinget-tls-use-cases" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-10-25" />
  <meta name="dct.abstract" content="TLS 1.3 introduces several changes to TLS 1.2 in order to improve the overall security and privacy provided by TLS. However some of these changes have a negative impact on network-based security solutions. While this may be viewed a feature, there are several real-life use case scenarios that are not easily solved without such network-based security solutions. In this document, we identify the TLS 1.3 changes that may negatively impact network-based security solutions and provide a set of use case scenarios that are not easily solved without such solutions." />
  <meta name="description" content="TLS 1.3 introduces several changes to TLS 1.2 in order to improve the overall security and privacy provided by TLS. However some of these changes have a negative impact on network-based security solutions. While this may be viewed a feature, there are several real-life use case scenarios that are not easily solved without such network-based security solutions. In this document, we identify the TLS 1.3 changes that may negatively impact network-based security solutions and provide a set of use case scenarios that are not easily solved without such solutions." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">TLS</td>
<td class="right">N. Cam-Winget</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">E. Wang</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">F. Andreasen</td>
</tr>
<tr>
<td class="left">Expires: April 28, 2018</td>
<td class="right">Cisco Systems</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 25, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">TLS 1.3 Impact on Network-Based Security<br />
  <span class="filename">draft-camwinget-tls-use-cases</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>TLS 1.3 introduces several changes to TLS 1.2 in order to improve the overall security and privacy provided by TLS. However some of these changes have a negative impact on network-based security solutions. While this may be viewed a feature, there are several real-life use case scenarios that are not easily solved without such network-based security solutions. In this document, we identify the TLS 1.3 changes that may negatively impact network-based security solutions and provide a set of use case scenarios that are not easily solved without such solutions.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on April 28, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements notation</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">TLS 1.3 Change Impact Overview</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Inbound Session Change Impacts</a>
</li>
<ul><li>2.1.1.   <a href="#rfc.section.2.1.1">Removal of Static RSA and Diffie-Hellman Cipher Suites</a>
</li>
</ul><li>2.2.   <a href="#rfc.section.2.2">Outbound Session Change Impacts</a>
</li>
<ul><li>2.2.1.   <a href="#rfc.section.2.2.1">Encrypted Server Certificate</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">Resumption and Pre-Shared Key</a>
</li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">Version Downgrade Protection</a>
</li>
<li>2.2.4.   <a href="#rfc.section.2.2.4">1-RTT Handshake</a>
</li>
<li>2.2.5.   <a href="#rfc.section.2.2.5">0-RTT Data</a>
</li>
<li>2.2.6.   <a href="#rfc.section.2.2.6">SNI Encryption in TLS Through Tunneling</a>
</li>
</ul></ul><li>3.   <a href="#rfc.section.3">Inbound Session Use Cases</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Use Case I1 - Data Center Protection</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Use Case I2 - Application Operation over NAT</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Use Case I3 - Compliance</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Use Case I4 - Crypto Security Audit</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Outbound Session Use Cases</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Use Case O1 - Acceptable Use Policy (AUP)</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Use Case O2 - Malware and Threat Protection</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Use Case O3 - IoT Endpoints</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Use Case O4 - Unpatched Endpoints</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Use Case O5 - Rapid Containment of New Vulnerability and Campaigns</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">Use Case O6 - End-of-Life Endpoint</a>
</li>
<li>4.7.   <a href="#rfc.section.4.7">Use Case O7 - Compliance</a>
</li>
<li>4.8.   <a href="#rfc.section.4.8">Use Case O8 - Crypto Security Audit</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">IANA considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.section.8">Change Log</a>
</li>
<li>9.   <a href="#rfc.section.9">Contributors</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<ul><li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Network-based security solutions such as Firewalls (FW) and Intrusion Prevention Systems (IPS) rely on network traffic inspection to implement perimeter-based security policies. Depending on the security functions required, these middleboxes can either be deployed as traffic monitoring devices or active in-line devices. A traffic monitoring middlebox may for example perform vulnerability detection, intrusion detection, crypto audit, compliance monitoring, etc. An active in-line middlebox may for example prevent malware download, block known malicous URLs, enforce use of strong ciphers, stop data exfiltration, etc. A significant portion of such security policies require clear-text traffic inspection above Layer 4, which becomes problematic when traffic is encrypted with Transport Layer Security (TLS) <a href="#RFC5246" class="xref">[RFC5246]</a>. Today, network-based security solutions typically address this problem by becoming a man-in-the-middle (MITM) for the TLS session according to one of the following two scenarios:</p>
<p></p>

<ol>
<li>Outbound Session, where the TLS session originates from inside the perimeter towards an entity on the outside</li>
<li>Inbound Session, where the TLS session originates from outside the perimeter towards an entity on the inside</li>
</ol>
<p id="rfc.section.1.p.3">For the outbound session scenario, a local root certificate and an accompanying (local) public/private key pair is generated. The local root certificate is installed on the inside entities for which TLS traffic is to be inspected, and the network security device(s) store a copy of the private key. During the TLS handshake, the network security device (hereafter referred to as a TLS proxy) modifies the certificate provided by the (outside) server and (re)signs it with the private key from the local root certificate. From here on, the TLS proxy has visibility into further exchanges between the client and server which enables it to to decrypt and inspect subsequent network traffic.</p>
<p id="rfc.section.1.p.4">For the Inbound session scenario, the TLS proxy is configured with a copy of the local servers' certificate(s) and corresponding private key(s). Based on the server certificate presented, the TLS proxy determines the corresponding private key, which again enables the TLS proxy to gain visibility into further exchanges between the client and server and hence decrypt subsequent network traffic.</p>
<p id="rfc.section.1.p.5">To date, there are a number of use case scenarios that rely on the above capabilities when used with TLS 1.2 <a href="#RFC5246" class="xref">[RFC5246]</a> or earlier. TLS 1.3 <a href="#I-D.ietf-tls-tls13" class="xref">[I-D.ietf-tls-tls13]</a> introduces several changes which prevent a number of these use case scenarios from being satisfied with the types of TLS proxy based capabilities that exist today.</p>
<p id="rfc.section.1.p.6">Currently deployed TLS proxies (middleboxes) may reduce the security of the TLS connection itself due to a combination of poor implementation and configuration <a href="#HTTPSintercept" class="xref">[HTTPSintercept]</a>, and they may compromise privacy when decrypting a TLS session. As such, it has been argued that preventing TLS proxies from working should be viewed as a feature of TLS 1.3 and that the proper way of solving these issues is to rely on endpoint (client and server) based solutions instead. We believe this is an overly constrained view of the problem that ignores a number of important real-life use case scenarios that improve the overall security posture. We also note that current endpoint-based TLS proxies suffer from many of the same security issues as the network-based TLS proxies (middleboxes) <a href="#HTTPSintercept" class="xref">[HTTPSintercept]</a>.</p>
<p id="rfc.section.1.p.7">The purpose of this document is to provide a representative set of <em>network based security</em> use case scenarios that are negatively impacted by TLS 1.3 and do not lend themselves to an endpoint-based alternative solution. For each use case scenario, we highlight the specific aspect(s) of TLS 1.3 that makes the use case problematic with a TLS proxy based solution and we explain why an endpoint-based only solution is not considered acceptable.</p>
<p id="rfc.section.1.p.8">It should be noted that this document is looking only at <em>security</em> use cases with a focus on identifying the problematic ones. The document does not offer specific solutions to these; the goal is to stimulate further discussion and explore possible solutions subsequently.</p>
<h2 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#requirements-notation" id="requirements-notation">Requirements notation</a>
</h2>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119, BCP 14 <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#tls-13-change-impact-overview" id="tls-13-change-impact-overview">TLS 1.3 Change Impact Overview</a>
</h1>
<p id="rfc.section.2.p.1">TlS 1.3 introduces several changes to TLS 1.2 in order to improve the overall privacy and security of TLS, however in doing so, some of the changes have a negative impact on network based security. In this section, we describe the TLS 1.3 changes that negatively impact network based security solutions. We divide the changes into two groups; those that impact inbound sessions and those that impact outbound sessions.</p>
<h2 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#inbound-session-change-impacts" id="inbound-session-change-impacts">Inbound Session Change Impacts</a>
</h2>
<h3 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> <a href="#removal-of-static-rsa-and-diffie-hellman-cipher-suites" id="removal-of-static-rsa-and-diffie-hellman-cipher-suites">Removal of Static RSA and Diffie-Hellman Cipher Suites</a>
</h3>
<p id="rfc.section.2.1.1.p.1">TLS 1.2 supports static RSA and Diffie-Hellman cipher suites, which enables the server's private key to be shared with server-side middle-boxes. TLS 1.3 has removed support for these cipher suites in favor of ephemeral mode Diffie-Hellman in order to provide perfect forward secrecy (PFS). As a result of this, it is no longer possible for a server to share a key with the middlebox a priori, which in turn implies that the middlebox cannot gain access to the TLS session data.</p>
<p id="rfc.section.2.1.1.p.2">Example scenarios that are impacted by this include network monitoring, troubleshooting, compliance, etc.</p>
<p id="rfc.section.2.1.1.p.3">For further details (and a suggestion solution), please refer to <a href="#I-D.green-tls-static-dh-in-tls13" class="xref">[I-D.green-tls-static-dh-in-tls13]</a>.</p>
<h2 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#outbound-session-change-impacts" id="outbound-session-change-impacts">Outbound Session Change Impacts</a>
</h2>
<h3 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> <a href="#encrypted-server-certificate" id="encrypted-server-certificate">Encrypted Server Certificate</a>
</h3>
<p id="rfc.section.2.2.1.p.1">In TLS 1.2, the ClientHello message is sent to the server's transport address (IP and port). The ClientHello message may include the Server Name Indication (SNI) to specify the actual server the client wishes to contact. This is useful when multiple "virtual servers" are hosted on a given transport address (IP and port). It also provides information about the domain the client is attempting to reach.</p>
<p id="rfc.section.2.2.1.p.2">The server replies with a ServerHello message, which contains the selected connection parameters, followed by a Certificate message, which contains the server's certificate and hence its identity.</p>
<p id="rfc.section.2.2.1.p.3">In TLS 1.2, the ClientHello, ServerHello and Certificate messages are all sent in clear-text, however in TLS 1.3, the Certificate message is encrypted thereby hiding the server identity from any intermediary. Note that even <em>if</em> the SNI is provided (in cleartext) by the client, there is no guarantee that the actual server responding is the one indicated in the SNI from the client.</p>
<p id="rfc.section.2.2.1.p.4">Example scenarios that are impacted by this involve selective network security, such as whitelists or blacklists based on security intelligence, regulatory requirements, categories (e.g. finanicial services), etc. An added challenge is that some of these scenarios require the middlebox to perform inspection, whereas other scenarios require the middlebox to not perform inspection.</p>
<h3 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> <a href="#resumption-and-pre-shared-key" id="resumption-and-pre-shared-key">Resumption and Pre-Shared Key</a>
</h3>
<p id="rfc.section.2.2.2.p.1">In TLS 1.2 and below, session resumption is provided by "session IDs" and "session tickets" <a href="#RFC5077" class="xref">[RFC5077]</a>. If the server does not want to honor a ticket, then it can simply initiate a full TLS handshake with the client as usual.</p>
<p id="rfc.section.2.2.2.p.2">In TLS 1.3, the above mechanism is replaced by Pre-Shared Keys (PSK), which can be negotiated as part of an initial handshake and then used in a subsequent handshake to perform resumption using the PSK. TLS 1.3 states that the client SHOULD include a "key_share" extension to enable the server to decline resumption and fall back to a full handshake, however it is not an absolute requirement.</p>
<p id="rfc.section.2.2.2.p.3">Example scenarios that are impacted by this are middleboxes that were not part of the initial handshake, and hence do not know the PSK. If the client does not include the "key_share" extension the middlebox cannot force a fallback to the full handshake. If the middlebox is required to inspect the session, it will have to fail the connection instead.</p>
<h3 id="rfc.section.2.2.3">
<a href="#rfc.section.2.2.3">2.2.3.</a> <a href="#version-downgrade-protection" id="version-downgrade-protection">Version Downgrade Protection</a>
</h3>
<p id="rfc.section.2.2.3.p.1">In TLS, the ClientHello message includes a list of supported protocol versions. The server will select the highest supported version and indicate its choice in the ServerHello message.</p>
<p id="rfc.section.2.2.3.p.2">In TLS 1.3, the random value in the ServerHello message includes a special value in the last eight bytes when the server negotiates either TLS 1.2 or TLS 1.1 and below. The special value(s) enable a TLS 1.3 client to detect an active attacker launching a downgrade attack when the client did indeed reach a TLS 1.3 server, provided ephemeral ciphers are being used.</p>
<p id="rfc.section.2.2.3.p.3">From a network security point of view, the primary impact of this change is that it requires the middlebox to be an active man-in-the-middle. This is not different from current behavior of middleboxes, as long as the middlebox effectively proxies between a client-to-middlebox and a middlebox-to-server TLS connection.</p>
<h3 id="rfc.section.2.2.4">
<a href="#rfc.section.2.2.4">2.2.4.</a> <a href="#rtt-handshake" id="rtt-handshake">1-RTT Handshake</a>
</h3>
<h3 id="rfc.section.2.2.5">
<a href="#rfc.section.2.2.5">2.2.5.</a> <a href="#rtt-data" id="rtt-data">0-RTT Data</a>
</h3>
<h3 id="rfc.section.2.2.6">
<a href="#rfc.section.2.2.6">2.2.6.</a> <a href="#sni-encryption-in-tls-through-tunneling" id="sni-encryption-in-tls-through-tunneling">SNI Encryption in TLS Through Tunneling</a>
</h3>
<p id="rfc.section.2.2.6.p.1">As noted above, with server certificates encrypted, the Server Name Indication (SNI) in the ClientHello message is the only information available in cleartext to indicate the client's targeted server, and the actual server reached may differ.</p>
<p><a href="#I-D.ietf-tls-sni-encryption" class="xref">[I-D.ietf-tls-sni-encryption]</a> proposes to hide the SNI in the ClientHello from middleboxes.</p>
<p id="rfc.section.2.2.6.p.3">Example scenarios that are impacted by this involve selective network security, such as whitelists or blacklists based on security intelligence, regulatory requirements, categories (e.g. financial services), etc. An added challenge is that some of these scenarios require the middlebox to perform inspection, whereas other scenarios require the middlebox to not perform inspection, however without the SNI, the middlebox may not have the information required to determine the actual scenario before it is too late.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#inbound-session-use-cases" id="inbound-session-use-cases">Inbound Session Use Cases</a>
</h1>
<h2 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#use-case-i1-data-center-protection" id="use-case-i1-data-center-protection">Use Case I1 - Data Center Protection</a>
</h2>
<h2 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#use-case-i2-application-operation-over-nat" id="use-case-i2-application-operation-over-nat">Use Case I2 - Application Operation over NAT</a>
</h2>
<h2 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#use-case-i3-compliance" id="use-case-i3-compliance">Use Case I3 - Compliance</a>
</h2>
<h2 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#InboundCryptoSecurityAudit" id="InboundCryptoSecurityAudit">Use Case I4 - Crypto Security Audit</a>
</h2>
<p id="rfc.section.3.4.p.1">Organizations may have policies around acceptable ciphers and certificates on their servers. Examples include no use of self-signed certificates, black or white-list Certificate Authority, etc. In TLS 1.2, the Certificate message was sent in clear-text, however in TLS 1.3 the message is encrypted thereby preventing either a network-based audit or policy enforcement around acceptable server certificates.</p>
<p id="rfc.section.3.4.p.2">While the audits and policy enforcements could in theory be done on the servers themselves, the premise of the use case is that not all servers are configured correctly and hence such an approach is unlikely to work in practice. A common example where this occurs includes lab servers.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#outbound-session-use-cases" id="outbound-session-use-cases">Outbound Session Use Cases</a>
</h1>
<h2 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#use-case-o1-acceptable-use-policy-aup" id="use-case-o1-acceptable-use-policy-aup">Use Case O1 - Acceptable Use Policy (AUP)</a>
</h2>
<p id="rfc.section.4.1.p.1">Enterprises deploy security devices to enforce Acceptable Use Policy (AUP) accroding to the IT and workplace policies.  The security devices, such as firewall/next-gen firewall and web proxy, act as middle boxes to scan traffic in the enterprise network for policy enforcement.</p>
<p id="rfc.section.4.1.p.2">Sample AUP policies are:</p>
<p id="rfc.section.4.1.p.3">"Employess are not allowed to access 'gaming' websites from enterprise network"</p>
<p id="rfc.section.4.1.p.4">"Temporary workers are not allowed to use enterprise network to upload video clips to Internet, but are allowed to watch video clips"</p>
<p id="rfc.section.4.1.p.5">Such enforcements are accomplished by controlling the DNS transactions and HTTP transactions.  A coase control is achieved by controlling the DNS response, however, in many cases, granular control is required at HTTP URL or Method levels, to distinguish a specific web page on a hosting site, or to differentiate between uploading and downloading operations.</p>
<p id="rfc.section.4.1.p.6">The security device requires to access plain text HTTP header for granular AUP control.</p>
<h2 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#use-case-o2-malware-and-threat-protection" id="use-case-o2-malware-and-threat-protection">Use Case O2 - Malware and Threat Protection</a>
</h2>
<p id="rfc.section.4.2.p.1">Enterprises adopt a multi-technology approach when it comes to malware and threat protection for the network assets.  This include solutions deployed on the endpoint, network and cloud.</p>
<p id="rfc.section.4.2.p.2">While endpoint application based solution is effective in protecting from malware and virus attecks, enterprises prefer to deploy multiple technologies for a multi-layer protection.  Network based solutions provide such additional protection with benefits including lower manangement costs.</p>
<p id="rfc.section.4.2.p.3">The network based solutions comprise security devices and applications that scan network traffic for the purpose from malware signatures to 0-day analysis.  The security functions require access to clear text HTTP or other application level streams.</p>
<h2 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#use-case-o3-iot-endpoints" id="use-case-o3-iot-endpoints">Use Case O3 - IoT Endpoints</a>
</h2>
<p id="rfc.section.4.3.p.1">As the Internet of Everything continues to evolve, more and more endpoints become connected to the Internet. From a security point of view, some of the challenges presented by these are:</p>
<p></p>

<ul>
<li>Constrained devices with limited resources (CPU, memory, etc.)</li>
<li>Lack of ability to install and update endpoint protection software.</li>
<li>Lack of software updates as new vulnerabilities are discovered.</li>
</ul>
<h2 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#use-case-o4-unpatched-endpoints" id="use-case-o4-unpatched-endpoints">Use Case O4 - Unpatched Endpoints</a>
</h2>
<p id="rfc.section.4.4.p.1">New vulnerabilities appear constantly and in spite of many advances in recent years in terms of automated software updates, especially in reaction to security vulnerabilities, the fact of the matter is that a very large number of endpoints continue to run versions of software with known vulnerabilities.</p>
<p id="rfc.section.4.4.p.2">In theory, these endpoints should of course be patched, but in practice, it is often not done which leaves the endpoint open to the vulnerability in question. A network-based security solution can look for attempted exploits of such vulnerabilities and stop them before they reach the unpatched endpoint.</p>
<h2 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#use-case-o5-rapid-containment-of-new-vulnerability-and-campaigns" id="use-case-o5-rapid-containment-of-new-vulnerability-and-campaigns">Use Case O5 - Rapid Containment of New Vulnerability and Campaigns</a>
</h2>
<p id="rfc.section.4.5.p.1">When a new vulnerability is discovered or an attack campaign is launched, it is important to patch the vulnerability or contain the campaign as quickly as possible. Patches however are not always available immediately, and even when they are, most endpoints are in practice not patched immediately, which leaves them open to the attack.</p>
<p id="rfc.section.4.5.p.2">A network-based security solution can look for attempted exploits of such new vulnerabilities or recognize an attack being launched based on security intelligence related to the campaign and stop them before they reach the vulnerable endpoint.</p>
<h2 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> <a href="#use-case-o6-end-of-life-endpoint" id="use-case-o6-end-of-life-endpoint">Use Case O6 - End-of-Life Endpoint</a>
</h2>
<p id="rfc.section.4.6.p.1">Older endpoints (and in some cases even new ones) will not receive any software updates. As new vulnerabilities inevitably are discovered, these endpoints will be vulnerable to exploits.</p>
<p id="rfc.section.4.6.p.2">A network-based security solution can help prevent such exploits.</p>
<h2 id="rfc.section.4.7">
<a href="#rfc.section.4.7">4.7.</a> <a href="#use-case-o7-compliance" id="use-case-o7-compliance">Use Case O7 - Compliance</a>
</h2>
<h2 id="rfc.section.4.8">
<a href="#rfc.section.4.8">4.8.</a> <a href="#use-case-o8-crypto-security-audit" id="use-case-o8-crypto-security-audit">Use Case O8 - Crypto Security Audit</a>
</h2>
<p id="rfc.section.4.8.p.1">This is a variation of the use in <a href="#InboundCryptoSecurityAudit" class="xref">Section 3.4</a></p>
<p id="rfc.section.4.8.p.2">Organizations may have policies around acceptable ciphers and certificates for client sessions, possibly based on the destination. Examples include no use of self-signed certificates, black or white-list Certificate Authority, etc. In TLS 1.2, the Certificate message was sent in clear-text, however in TLS 1.3 the message is encrypted thereby preventing either a network-based audit or policy enforcement around acceptable server certificates.</p>
<p id="rfc.section.4.8.p.3">While the audits and policy enforcements could in theory be done on the clients themselves, not all clients are configured correctly and may not even be directly under configuration control of the organization in question (e.g. due to Bring Your Own Device).</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana-considerations" id="iana-considerations">IANA considerations</a>
</h1>
<p id="rfc.section.5.p.1">This document does not include IANA considerations.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">TBD</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.7.p.1">David McGrew provided the Security Audit use cases.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#change-log" id="change-log">Change Log</a>
</h1>
<p id="rfc.section.8.p.1">First version -00</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#contributors" id="contributors">Contributors</a>
</h1>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h2 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-tls-tls13">[I-D.ietf-tls-tls13]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-tls13-21">The Transport Layer Security (TLS) Protocol Version 1.3</a>", Internet-Draft draft-ietf-tls-tls13-21, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
</tbody></table>
<h2 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="BreakTLS">[BreakTLS]</b></td>
<td class="top">
<a>Bhargavan, K.</a>, <a>Delignat-Lavaud, A.</a>, <a>Fournet, C.</a>, <a>Pironti, A.</a> and <a>P. Strub</a>, "<a>Triple Handshakes and Cookie Cutters: Breaking and Fixing Authentication over TLS</a>", IEEE Symposium on Security and Privacy , 2014.</td>
</tr>
<tr>
<td class="reference"><b id="HTTPSintercept">[HTTPSintercept]</b></td>
<td class="top">
<a>Durumeric, Z.</a>, <a>Ma, Z.</a>, <a>Springall, D.</a>, <a>Barnes, R.</a>, <a>Sullivan, N.</a>, <a>Bursztein, E.</a>, <a>Mailey, M.</a>, <a>Halderman, J.</a> and <a>V. Paxson</a>, "<a href="https://jhalderm.com/pub/papers/interception-ndss17.pdf">The Security Impact of HTTPS Interception</a>", February 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.green-tls-static-dh-in-tls13">[I-D.green-tls-static-dh-in-tls13]</b></td>
<td class="top">
<a>Green, M.</a>, <a>Droms, R.</a>, <a>Housley, R.</a>, <a>Turner, P.</a> and <a>S. Fenter</a>, "<a href="https://tools.ietf.org/html/draft-green-tls-static-dh-in-tls13-01">Data Center use of Static Diffie-Hellman in TLS 1.3</a>", Internet-Draft draft-green-tls-static-dh-in-tls13-01, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-tls-sni-encryption">[I-D.ietf-tls-sni-encryption]</b></td>
<td class="top">
<a>Huitema, C.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/draft-ietf-tls-sni-encryption-00">SNI Encryption in TLS Through Tunneling</a>", Internet-Draft draft-ietf-tls-sni-encryption-00, August 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5077">[RFC5077]</b></td>
<td class="top">
<a>Salowey, J.</a>, <a>Zhou, H.</a>, <a>Eronen, P.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/rfc5077">Transport Layer Security (TLS) Session Resumption without Server-Side State</a>", RFC 5077, DOI 10.17487/RFC5077, January 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nancy Cam-Winget</span> 
	  <span class="n hidden">
		<span class="family-name">Cam-Winget</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span class="vcardline">3550 Cisco Way</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ncamwing@cisco.com">ncamwing@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eric Wang</span> 
	  <span class="n hidden">
		<span class="family-name">Wang</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span class="vcardline">3550 Cisco Way</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">CA</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ejwang@cisco.com">ejwang@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Flemming Andreasen</span> 
	  <span class="n hidden">
		<span class="family-name">Andreasen</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems</span>
	<span class="adr">
	  <span class="vcardline">111 Wood Avenue South</span>

	  <span class="vcardline">
		<span class="locality">Iselin</span>,  
		<span class="region">NJ</span> 
		<span class="code">08830</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:fandreas@cisco.com">fandreas@cisco.com</a></span>

  </address>
</div>

</body>
</html>
